<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>SettleUp - Split Bills in USDC</title>
Â  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
Â  <style>
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
Â  Â Â 
Â  Â  * {
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  Â  box-sizing: border-box;
Â  Â  }
Â  Â Â 
Â  Â  body {
Â  Â  Â  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  min-height: 100vh;
Â  Â  Â  padding: 20px;
Â  Â  Â  color: #1f2937;
Â  Â  }
Â  Â Â 
Â  Â  .container {
Â  Â  Â  max-width: 480px;
Â  Â  Â  margin: 0 auto;
Â  Â  }
Â  Â Â 
Â  Â  .header {
Â  Â  Â  text-align: center;
Â  Â  Â  margin-bottom: 32px;
Â  Â  Â  animation: fadeIn 0.6s ease-out;
Â  Â  }
Â  Â Â 
Â  Â  .logo {
Â  Â  Â  font-size: 48px;
Â  Â  Â  margin-bottom: 8px;
Â  Â  }
Â  Â Â 
Â  Â  h1 {
Â  Â  Â  color: white;
Â  Â  Â  font-size: 32px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  text-shadow: 0 2px 10px rgba(0,0,0,0.2);
Â  Â  }
Â  Â Â 
Â  Â  .subtitle {
Â  Â  Â  color: rgba(255,255,255,0.9);
Â  Â  Â  font-size: 14px;
Â  Â  }
Â  Â Â 
Â  Â  .card {
Â  Â  Â  background: white;
Â  Â  Â  border-radius: 24px;
Â  Â  Â  padding: 28px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
Â  Â  Â  animation: slideUp 0.6s ease-out;
Â  Â  }
Â  Â Â 
Â  Â  @keyframes fadeIn {
Â  Â  Â  from { opacity: 0; transform: translateY(-20px); }
Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  }
Â  Â Â 
Â  Â  @keyframes slideUp {
Â  Â  Â  from { opacity: 0; transform: translateY(30px); }
Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  }
Â  Â Â 
Â  Â  .wallet-status {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  padding: 16px;
Â  Â  Â  background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
Â  Â  Â  border-radius: 16px;
Â  Â  Â  margin-bottom: 24px;
Â  Â  Â  border: 2px solid #86efac;
Â  Â  }
Â  Â Â 
Â  Â  .wallet-info {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 4px;
Â  Â  }
Â  Â Â 
Â  Â  .wallet-address {
Â  Â  Â  font-weight: 600;
Â  Â  Â  color: #15803d;
Â  Â  Â  font-size: 14px;
Â  Â  }
Â  Â Â 
Â  Â  .usdc-balance {
Â  Â  Â  font-size: 12px;
Â  Â  Â  color: #16a34a;
Â  Â  }
Â  Â Â 
Â  Â  .status-dot {
Â  Â  Â  width: 8px;
Â  Â  Â  height: 8px;
Â  Â  Â  background: #22c55e;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  animation: pulse 2s infinite;
Â  Â  }
Â  Â Â 
Â  Â  @keyframes pulse {
Â  Â  Â  0%, 100% { opacity: 1; }
Â  Â  Â  50% { opacity: 0.5; }
Â  Â  }
Â  Â Â 
Â  Â  .section-title {
Â  Â  Â  font-size: 18px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  color: #111827;
Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 8px;
Â  Â  }
Â  Â Â 
Â  Â  .input-group {
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â Â 
Â  Â  label {
Â  Â  Â  display: block;
Â  Â  Â  font-size: 13px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  color: #6b7280;
Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  text-transform: uppercase;
Â  Â  Â  letter-spacing: 0.5px;
Â  Â  }
Â  Â Â 
Â  Â  input {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 14px 16px;
Â  Â  Â  border: 2px solid #e5e7eb;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  font-family: inherit;
Â  Â  Â  transition: all 0.2s;
Â  Â  Â  background: #f9fafb;
Â  Â  }
Â  Â Â 
Â  Â  input:focus {
Â  Â  Â  outline: none;
Â  Â  Â  border-color: #667eea;
Â  Â  Â  background: white;
Â  Â  Â  box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
Â  Â  }
Â  Â Â 
Â  Â  input::placeholder {
Â  Â  Â  color: #9ca3af;
Â  Â  }
Â  Â Â 
Â  Â  button {
Â  Â  Â  width: 100%;
Â  Â  Â  padding: 16px;
Â  Â  Â  border: none;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  font-size: 16px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  font-family: inherit;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: all 0.2s;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  gap: 8px;
Â  Â  }
Â  Â Â 
Â  Â  .btn-primary {
Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  color: white;
Â  Â  Â  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
Â  Â  }
Â  Â Â 
Â  Â  .btn-primary:hover:not(:disabled) {
Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
Â  Â  }
Â  Â Â 
Â  Â  .btn-secondary {
Â  Â  Â  background: #f3f4f6;
Â  Â  Â  color: #374151;
Â  Â  Â  padding: 12px 16px;
Â  Â  Â  width: auto;
Â  Â  Â  margin: 0 6px 6px 0;
Â  Â  Â  font-size: 14px;
Â  Â  }
Â  Â Â 
Â  Â  .btn-secondary:hover:not(:disabled) {
Â  Â  Â  background: #e5e7eb;
Â  Â  }
Â  Â Â 
Â  Â  .btn-approve {
Â  Â  Â  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
Â  Â  Â  color: white;
Â  Â  Â  margin-bottom: 16px;
Â  Â  }
Â  Â Â 
Â  Â  button:disabled {
Â  Â  Â  opacity: 0.5;
Â  Â  Â  cursor: not-allowed;
Â  Â  Â  transform: none !important;
Â  Â  }
Â  Â Â 
Â  Â  .contacts-section {
Â  Â  Â  background: #f9fafb;
Â  Â  Â  border-radius: 16px;
Â  Â  Â  padding: 16px;
Â  Â  Â  margin-bottom: 20px;
Â  Â  }
Â  Â Â 
Â  Â  .contacts-list {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  Â  margin-bottom: 12px;
Â  Â  }
Â  Â Â 
Â  Â  .contact-btn {
Â  Â  Â  background: white;
Â  Â  Â  border: 2px solid #e5e7eb;
Â  Â  Â  padding: 10px 16px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  font-size: 14px;
Â  Â  Â  font-weight: 500;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: all 0.2s;
Â  Â  Â  color: #374151;
Â  Â  Â  position: relative;
Â  Â  }
Â  Â Â 
Â  Â  .contact-btn:hover {
Â  Â  Â  border-color: #667eea;
Â  Â  Â  background: #f3f4f6;
Â  Â  Â  transform: translateY(-1px);
Â  Â  }
Â  Â Â 
Â  Â  .contact-btn.you {
Â  Â  Â  background: #dbeafe;
Â  Â  Â  border-color: #3b82f6;
Â  Â  Â  color: #1e40af;
Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â Â 
Â  Â  .contact-btn .delete-icon {
Â  Â  Â  position: absolute;
Â  Â  Â  top: -8px;
Â  Â  Â  right: -8px;
Â  Â  Â  background: #dc2626;
Â  Â  Â  color: white;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  width: 24px;
Â  Â  Â  height: 24px;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  font-size: 14px;
Â  Â  Â  cursor: pointer;
Â  Â  Â  opacity: 0;
Â  Â  Â  transition: opacity 0.2s;
Â  Â  Â  border: 2px solid white;
Â  Â  }
Â  Â Â 
Â  Â  .contact-btn:hover .delete-icon {
Â  Â  Â  opacity: 1;
Â  Â  }
Â  Â Â 
Â  Â  .add-contact-btn {
Â  Â  Â  background: #10b981;
Â  Â  Â  color: white;
Â  Â  Â  border: none;
Â  Â  }
Â  Â Â 
Â  Â  .add-contact-btn:hover {
Â  Â  Â  background: #059669;
Â  Â  }
Â  Â Â 
Â  Â  .toast {
Â  Â  Â  position: fixed;
Â  Â  Â  bottom: 24px;
Â  Â  Â  left: 50%;
Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  background: #1f2937;
Â  Â  Â  color: white;
Â  Â  Â  padding: 16px 24px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  font-size: 14px;
Â  Â  Â  font-weight: 500;
Â  Â  Â  box-shadow: 0 10px 40px rgba(0,0,0,0.3);
Â  Â  Â  z-index: 1000;
Â  Â  Â  animation: toastIn 0.3s ease-out, toastOut 0.3s ease-in 2.7s forwards;
Â  Â  Â  max-width: 90%;
Â  Â  }
Â  Â Â 
Â  Â  @keyframes toastIn {
Â  Â  Â  from { opacity: 0; transform: translateX(-50%) translateY(20px); }
Â  Â  Â  to { opacity: 1; transform: translateX(-50%) translateY(0); }
Â  Â  }
Â  Â Â 
Â  Â  @keyframes toastOut {
Â  Â  Â  to { opacity: 0; transform: translateX(-50%) translateY(20px); }
Â  Â  }
Â  Â Â 
Â  Â  .balance-item {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  padding: 16px;
Â  Â  Â  background: #f9fafb;
Â  Â  Â  border: 2px solid #e5e7eb;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  margin-bottom: 12px;
Â  Â  Â  transition: all 0.2s;
Â  Â  }
Â  Â Â 
Â  Â  .balance-item:hover {
Â  Â  Â  border-color: #d1d5db;
Â  Â  Â  background: white;
Â  Â  }
Â  Â Â 
Â  Â  .balance-info {
Â  Â  Â  flex: 1;
Â  Â  }
Â  Â Â 
Â  Â  .balance-amount {
Â  Â  Â  font-size: 18px;
Â  Â  Â  font-weight: 700;
Â  Â  Â  margin-bottom: 4px;
Â  Â  }
Â  Â Â 
Â  Â  .balance-amount.positive {
Â  Â  Â  color: #15803d;
Â  Â  }
Â  Â Â 
Â  Â  .balance-amount.negative {
Â  Â  Â  color: #dc2626;
Â  Â  }
Â  Â Â 
Â  Â  .balance-name {
Â  Â  Â  font-size: 14px;
Â  Â  Â  color: #6b7280;
Â  Â  Â  font-weight: 500;
Â  Â  }
Â  Â Â 
Â  Â  .btn-settle {
Â  Â  Â  padding: 10px 20px;
Â  Â  Â  background: #10b981;
Â  Â  Â  color: white;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-size: 14px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  width: auto;
Â  Â  }
Â  Â Â 
Â  Â  .btn-settle:hover {
Â  Â  Â  background: #059669;
Â  Â  }
Â  Â Â 
Â  Â  .empty-state {
Â  Â  Â  text-align: center;
Â  Â  Â  padding: 40px 20px;
Â  Â  Â  color: #9ca3af;
Â  Â  }
Â  Â Â 
Â  Â  .empty-state-icon {
Â  Â  Â  font-size: 48px;
Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  opacity: 0.5;
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <div class="header">
Â  Â  Â  <div class="logo">ğŸ’°</div>
Â  Â  Â  <h1>SettleUp</h1>
Â  Â  Â  <p class="subtitle">Split bills seamlessly on Base</p>
Â  Â  </div>

Â  Â  <div class="card">
Â  Â  Â  <button id="connectWallet" class="btn-primary">
Â  Â  Â  Â  ğŸ”— Connect Wallet
Â  Â  Â  </button>
Â  Â  Â Â 
Â  Â  Â  <div id="walletStatus" style="display:none;">
Â  Â  Â  Â  <div class="wallet-status">
Â  Â  Â  Â  Â  <div class="wallet-info">
Â  Â  Â  Â  Â  Â  <div class="wallet-address" id="walletAddress"></div>
Â  Â  Â  Â  Â  Â  <div class="usdc-balance" id="usdcBalance"></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="status-dot"></div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <button id="approveUSDC" class="btn-approve" style="display:none;">
Â  Â  Â  Â  Â  âš¡ Approve USDC
Â  Â  Â  Â  </button>

Â  Â  Â  Â  <div class="contacts-section">
Â  Â  Â  Â  Â  <h2 class="section-title" style="margin-bottom: 12px;">ğŸ‘¥ Your Contacts</h2>
Â  Â  Â  Â  Â  <div class="contacts-list" id="contactsList"></div>
Â  Â  Â  Â  Â  <button id="addContactBtn" class="add-contact-btn" style="width: 100%; padding: 12px;">+ Add Contact</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="card" id="addExpenseCard" style="display:none;">
Â  Â  Â  <h2 class="section-title">
Â  Â  Â  Â  <span>ğŸ“</span> Add Expense
Â  Â  Â  </h2>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>Amount (USDC)</label>
Â  Â  Â  Â  <input type="number" inputmode="decimal" step="0.01" id="amount" placeholder="30.00" />
Â  Â  Â  Â  <div id="addExpenseStatus"></div>
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>Payer (Who Paid)</label>
Â  Â  Â  Â  <input type="text" id="payer" placeholder="Click a contact or enter address" />
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>Participants (Who Owe)</label>
Â  Â  Â  Â  <input type="text" id="participants" placeholder="Click contacts or enter addresses" />
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>Description (Category)</label>
Â  Â  Â  Â  <input type="text" id="expenseDesc" placeholder="movie, dinner, groceries, etc." />
Â  Â  Â  </div>

Â  Â  Â  <button id="addExpense" class="btn-primary">
Â  Â  Â  Â  ğŸ’³ Record Expense
Â  Â  Â  </button>
Â  Â  </div>

Â  Â  <div class="card" id="adjustCard" style="display:none;">
Â  Â  Â  <h2 class="section-title">
Â  Â  Â  Â  <span>ğŸ”§</span> Adjust Balance
Â  Â  Â  </h2>
Â  Â  Â Â 
Â  Â  Â  <div style="background: #eff6ff; border: 2px solid #bfdbfe; border-radius: 12px; padding: 12px 16px; margin-bottom: 20px; font-size: 13px; color: #1e40af; line-height: 1.5;">
Â  Â  Â  Â  <strong>Note:</strong> Correct a balance if you recorded the wrong amount. Only you can adjust what others owe you.
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>Person (Who Owes You)</label>
Â  Â  Â  Â  <input type="text" id="adjustDebtor" placeholder="Click a contact or enter address" />
Â  Â  Â  </div>

Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  <label>New Amount (USDC)</label>
Â  Â  Â  Â  <input type="number" inputmode="decimal" step="0.01" id="adjustAmount" placeholder="0.00" />
Â  Â  Â  </div>

Â  Â  Â  <button id="adjustBalance" class="btn-primary">
Â  Â  Â  Â  ğŸ”§ Update Balance
Â  Â  Â  </button>
Â  Â  Â Â 
Â  Â  Â  <div id="adjustStatus"></div>
Â  Â  </div>

Â  Â  <div class="card" id="balancesCard" style="display:none;">
Â  Â  Â  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
Â  Â  Â  Â  <h2 class="section-title" style="margin: 0;">
Â  Â  Â  Â  Â  <span>ğŸ’µ</span> Balances
Â  Â  Â  Â  </h2>
Â  Â  Â  Â  <button id="refreshBalances" class="btn-secondary">
Â  Â  Â  Â  Â  ğŸ”„ Refresh
Â  Â  Â  Â  </button>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div id="balances">
Â  Â  Â  Â  <div class="empty-state">
Â  Â  Â  Â  Â  <div class="empty-state-icon">ğŸ“Š</div>
Â  Â  Â  Â  Â  <p>Connect wallet to view balances</p>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  const contractAddress = "0xf6b491763ca2e099bb6c9d3e573524c426152aeb";
Â  Â  const USDC = "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913";

Â  Â  const contractABI = [
Â  Â  Â  { "inputs": [{ "internalType": "address", "name": "usdcAddress", "type": "address" }], "name": "initialize", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
Â  Â  Â  { "inputs": [
Â  Â  Â  Â  Â  { "internalType": "uint256", "name": "amount", "type": "uint256" },
Â  Â  Â  Â  Â  { "internalType": "address", "name": "payer", "type": "address" },
Â  Â  Â  Â  Â  { "internalType": "address[]", "name": "participants", "type": "address[]" },
Â  Â  Â  Â  Â  { "internalType": "string", "name": "category", "type": "string" }
Â  Â  Â  Â  ], "name": "addExpense", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
Â  Â  Â  { "inputs": [{ "internalType": "address", "name": "creditor", "type": "address" }, { "internalType": "string", "name": "category", "type": "string" }], "name": "settle", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
Â  Â  Â  { "inputs": [
Â  Â  Â  Â  Â  { "internalType": "address", "name": "debtor", "type": "address" },
Â  Â  Â  Â  Â  { "internalType": "uint256", "name": "newAmount", "type": "uint256" },
Â  Â  Â  Â  Â  { "internalType": "string", "name": "category", "type": "string" }
Â  Â  Â  Â  ], "name": "adjustBalance", "outputs": [], "stateMutability": "nonpayable", "type": "function" },
Â  Â  Â  { "inputs": [
Â  Â  Â  Â  Â  { "internalType": "address", "name": "debtor", "type": "address" },
Â  Â  Â  Â  Â  { "internalType": "address", "name": "creditor", "type": "address" },
Â  Â  Â  Â  Â  { "internalType": "string", "name": "category", "type": "string" }
Â  Â  Â  Â  ], "name": "getBalance", "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }], "stateMutability": "view", "type": "function" }
Â  Â  ];

Â  Â  let provider, signer, contract, account, usdcContract;
Â  Â  let contacts = {};

Â  Â  function shortAddr(addr) { return addr.slice(0,6) + '...' + addr.slice(-4); }
Â  Â Â 
Â  Â  function toast(msg) {Â 
Â  Â  Â  const el = document.createElement('div');Â 
Â  Â  Â  el.className = 'toast';Â 
Â  Â  Â  el.textContent = msg;Â 
Â  Â  Â  document.body.appendChild(el);Â 
Â  Â  Â  setTimeout(() => el.remove(), 3000);Â 
Â  Â  }
Â  Â Â 
Â  Â  function loadContacts() {
Â  Â  Â  const stored = localStorage.getItem("settleup-contacts");
Â  Â  Â  if (stored) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  contacts = JSON.parse(stored);
Â  Â  Â  Â  } catch(e) {
Â  Â  Â  Â  Â  console.error("Failed to load contacts", e);
Â  Â  Â  Â  Â  contacts = {};
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }
Â  Â Â 
Â  Â  function saveContacts() {
Â  Â  Â  localStorage.setItem("settleup-contacts", JSON.stringify(contacts));
Â  Â  }
Â  Â Â 
Â  Â  function addContact(address, name) {
Â  Â  Â  const addr = address.toLowerCase();
Â  Â  Â  if (!name || name.trim() === "") return toast("âš ï¸ Name required");
Â  Â  Â  contacts[addr] = name.trim();
Â  Â  Â  saveContacts();
Â  Â  Â  renderContacts();
Â  Â  Â  toast(`âœ… Added ${name}`);
Â  Â  }
Â  Â Â 
Â  Â  function deleteContact(address) {
Â  Â  Â  const addr = address.toLowerCase();
Â  Â  Â  if (addr === account.toLowerCase()) {
Â  Â  Â  Â  return toast("âŒ Can't delete yourself");
Â  Â  Â  }
Â  Â  Â  delete contacts[addr];
Â  Â  Â  saveContacts();
Â  Â  Â  renderContacts();
Â  Â  Â  toast("âœ… Deleted");
Â  Â  }
Â  Â Â 
Â  Â  function renderContacts() {
Â  Â  Â  const list = document.getElementById("contactsList");
Â  Â  Â  list.innerHTML = "";
Â  Â  Â Â 
Â  Â  Â  if (!account) return;
Â  Â  Â Â 
Â  Â  Â  const youBtn = document.createElement("button");
Â  Â  Â  youBtn.className = "contact-btn you";
Â  Â  Â  youBtn.textContent = "ğŸ“ You";
Â  Â  Â  youBtn.style.pointerEvents = "auto";
Â  Â  Â  youBtn.onclick = (e) => {
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  document.getElementById("payer").value = account;
Â  Â  Â  Â  toast(`âœ… Payer: You`);
Â  Â  Â  };
Â  Â  Â  list.appendChild(youBtn);
Â  Â  Â Â 
Â  Â  Â  Object.entries(contacts).forEach(([addr, name]) => {
Â  Â  Â  Â  if (addr === account.toLowerCase()) return;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const btn = document.createElement("button");
Â  Â  Â  Â  btn.className = "contact-btn";
Â  Â  Â  Â  btn.style.position = "relative";
Â  Â  Â  Â Â 
Â  Â  Â  Â  const deleteIcon = document.createElement("div");
Â  Â  Â  Â  deleteIcon.className = "delete-icon";
Â  Â  Â  Â  deleteIcon.textContent = "âœ•";
Â  Â  Â  Â  deleteIcon.onclick = (e) => {
Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  e.stopPropagation();
Â  Â  Â  Â  Â  if (confirm(`Delete ${name}?`)) {
Â  Â  Â  Â  Â  Â  deleteContact(addr);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  btn.textContent = name;
Â  Â  Â  Â  btn.appendChild(deleteIcon);
Â  Â  Â  Â Â 
Â  Â  Â  Â  btn.onclick = (e) => {
Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  const participants = document.getElementById("participants").value.trim();
Â  Â  Â  Â  Â  const arr = participants ? participants.split(",").map(x => x.trim()) : [];
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  if (!arr.map(x => x.toLowerCase()).includes(addr)) {
Â  Â  Â  Â  Â  Â  arr.push(addr);
Â  Â  Â  Â  Â  Â  document.getElementById("participants").value = arr.join(", ");
Â  Â  Â  Â  Â  Â  toast(`âœ… Added ${name}`);
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  toast("âš ï¸ Already added");
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  list.appendChild(btn);
Â  Â  Â  });
Â  Â  }

Â  Â  async function connectWallet() {
Â  Â  Â  if (!window.ethereum) return toast("âš ï¸ Please install MetaMask!");
Â  Â  Â Â 
Â  Â  Â  const btn = document.getElementById("connectWallet");
Â  Â  Â  btn.disabled = true;
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  provider = new ethers.providers.Web3Provider(window.ethereum);
Â  Â  Â  Â  await provider.send("eth_requestAccounts", []);
Â  Â  Â  Â  signer = provider.getSigner();
Â  Â  Â  Â  account = await signer.getAddress();
Â  Â  Â  Â  contract = new ethers.Contract(contractAddress, contractABI, signer);

Â  Â  Â  Â  const net = await provider.getNetwork();
Â  Â  Â  Â  if (net.chainId !== 8453) {
Â  Â  Â  Â  Â  toast("âš ï¸ Switching to Base Mainnet...");
Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  await window.ethereum.request({Â 
Â  Â  Â  Â  Â  Â  Â  method: 'wallet_switchEthereumChain',Â 
Â  Â  Â  Â  Â  Â  Â  params: [{ chainId: '0x2105' }]Â 
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  location.reload();
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  toast("âŒ Please switch to Base Mainnet manually");
Â  Â  Â  Â  Â  Â  btn.disabled = false;
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  loadContacts();
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!contacts[account.toLowerCase()]) {
Â  Â  Â  Â  Â  const userName = prompt("What's your name?", "Me");
Â  Â  Â  Â  Â  if (userName) {
Â  Â  Â  Â  Â  Â  addContact(account, userName);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  document.getElementById("walletAddress").textContent = shortAddr(account);
Â  Â  Â  Â  document.getElementById("payer").value = account;
Â  Â  Â  Â  document.getElementById("walletStatus").style.display = "block";
Â  Â  Â  Â  document.getElementById("addExpenseCard").style.display = "block";
Â  Â  Â  Â  document.getElementById("adjustCard").style.display = "block";
Â  Â  Â  Â  document.getElementById("balancesCard").style.display = "block";
Â  Â  Â  Â  btn.style.display = "none";

Â  Â  Â  Â  renderContacts();
Â  Â  Â  Â  await initUSDC();
Â  Â  Â  Â  await refreshBalances();

Â  Â  Â  Â  window.ethereum.on('accountsChanged', () => location.reload());
Â  Â  Â  Â  window.ethereum.on('chainChanged', () => location.reload());
Â  Â  Â  Â Â 
Â  Â  Â  Â  toast("âœ… Connected successfully!");
Â  Â  Â  } catch (e) {Â 
Â  Â  Â  Â  toast("âŒ Connection failed");
Â  Â  Â  Â  console.error(e);
Â  Â  Â  } finally {Â 
Â  Â  Â  Â  btn.disabled = false;Â 
Â  Â  Â  }
Â  Â  }

Â  Â  async function initUSDC() {
Â  Â  Â  usdcContract = new ethers.Contract(USDC, [
Â  Â  Â  Â  "function balanceOf(address) view returns (uint256)",
Â  Â  Â  Â  "function allowance(address,address) view returns (uint256)",
Â  Â  Â  Â  "function approve(address,uint256) returns (bool)"
Â  Â  Â  ], signer);
Â  Â  Â Â 
Â  Â  Â  const bal = await usdcContract.balanceOf(account);
Â  Â  Â  document.getElementById("usdcBalance").textContent = `ğŸ’µ ${ethers.utils.formatUnits(bal, 6)} USDC`;
Â  Â  Â Â 
Â  Â  Â  const allowance = await usdcContract.allowance(account, contractAddress);
Â  Â  Â  if (allowance.lt(ethers.utils.parseUnits("1000", 6))) {
Â  Â  Â  Â  document.getElementById("approveUSDC").style.display = "block";
Â  Â  Â  }
Â  Â  }

Â  Â  document.getElementById("approveUSDC").onclick = async () => {
Â  Â  Â  const btn = document.getElementById("approveUSDC");
Â  Â  Â  btn.disabled = true;
Â  Â  Â Â 
Â  Â  Â  try {
Â  Â  Â  Â  const tx = await usdcContract.approve(contractAddress, ethers.constants.MaxUint256);
Â  Â  Â  Â  toast("â³ Approving USDC...");
Â  Â  Â  Â  await tx.wait();
Â  Â  Â  Â  btn.style.display = "none";
Â  Â  Â  Â  toast("âœ… USDC approved!");
Â  Â  Â  Â  await initUSDC();
Â  Â  Â  } catch (e) {Â 
Â  Â  Â  Â  toast("âŒ Approval failed");
Â  Â  Â  Â  console.error(e);
Â  Â  Â  } finally {Â 
Â  Â  Â  Â  btn.disabled = false;Â 
Â  Â  Â  }
Â  Â  };

Â  Â  document.getElementById("addContactBtn").onclick = () => {
Â  Â  Â  const addr = prompt("Address (0x...):");
Â  Â  Â  if (!addr) return;
Â  Â  Â Â 
Â  Â  Â  if (!ethers.utils.isAddress(addr)) {
Â  Â  Â  Â  return toast("âŒ Invalid address");
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  const name = prompt("Name for this contact:");
Â  Â  Â  if (name) {
Â  Â  Â  Â  addContact(addr, name);
Â  Â  Â  }
Â  Â  };

Â  Â  async function addExpense() {
Â  Â  Â  const amountInput = document.getElementById("amount").value.trim();
Â  Â  Â  const payer = document.getElementById("payer").value.trim();
Â  Â  Â  const participantsInput = document.getElementById("participants").value.trim();
Â  Â  Â  const desc = document.getElementById("expenseDesc").value.trim() || "Expense";
Â  Â  Â  const statusEl = document.getElementById("addExpenseStatus");

Â  Â  Â  if (!amountInput || !payer || !participantsInput) {
Â  Â  Â  Â  return toast("âš ï¸ Please fill all required fields");
Â  Â  Â  }
Â  Â  Â Â 
Â  Â  Â  if (!ethers.utils.isAddress(payer)) {
Â  Â  Â  Â  return toast("âš ï¸ Invalid payer address");
Â  Â  Â  }

Â  Â  Â  const amountFloat = parseFloat(amountInput);
Â  Â  Â  if (isNaN(amountFloat) || amountFloat <= 0) {
Â  Â  Â  Â  return toast("âš ï¸ Invalid amount");
Â  Â  Â  }

Â  Â  Â  const amount = ethers.utils.parseUnits(amountInput, 6);

Â  Â  Â  const participants = [...new Set(
Â  Â  Â  Â  participantsInput
Â  Â  Â  Â  Â  .split(",")
Â  Â  Â  Â  Â  .map(a => a.trim())
Â  Â  Â  Â  Â  .filter(a => ethers
